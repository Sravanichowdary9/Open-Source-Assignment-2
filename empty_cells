#!/bin/bash

# Usage: ./empty_cells <file> <separator>
# Example: ./empty_cells bgg_dataset.txt ";"

if [[ $# -ne 2 ]]; then
    echo "Usage: $0 <file> <separator>" >&2
    exit 1
fi

file="$1"
sep="$2"

awk -v FS="$sep" '
NR == 1 {
    # store column headers
    for (i = 1; i <= NF; i++) {
        headers[i] = $i
        empty[i] = 0
    }
    max_col = NF
    next
}
{
    # count empty fields
    for (i = 1; i <= NF; i++) {
        if ($i == "") {
            empty[i]++
        }
    }
    # handle rows with fewer fields than header
    if (NF < max_col) {
        for (i = NF+1; i <= max_col; i++) {
            empty[i]++
        }
    }
}
END {
    for (i = 1; i <= max_col; i++) {
        print headers[i] ": " empty[i]
    }
}
' "$file"

